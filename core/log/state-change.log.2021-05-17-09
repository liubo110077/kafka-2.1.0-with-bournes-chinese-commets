[2021-05-17 09:31:47,955] TRACE [Controller id=0 epoch=3] Received response {error_code=0} for request UPDATE_METADATA with correlation id 0 sent to broker bolius-mbp.cn.ibm.com:9092 (id: 0 rack: null) (state.change.logger)
[2021-05-17 09:51:45,826] TRACE [Controller id=0 epoch=4] Received response {error_code=0} for request UPDATE_METADATA with correlation id 0 sent to broker bolius-mbp.cn.ibm.com:9092 (id: 0 rack: null) (state.change.logger)
[2021-05-17 09:54:54,813] TRACE [Controller id=0 epoch=4] Changed partition test-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2021-05-17 09:54:54,826] TRACE [Controller id=0 epoch=4] Changed state of replica 0 for partition test-topic-0 from NonExistentReplica to NewReplica (state.change.logger)
[2021-05-17 09:54:54,861] TRACE [Controller id=0 epoch=4] Changed partition test-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), zkVersion=0) (state.change.logger)
[2021-05-17 09:54:54,863] TRACE [Controller id=0 epoch=4] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=4, leader=0, leaderEpoch=0, isr=0, zkVersion=0, replicas=0, isNew=true) to broker 0 for partition test-topic-0 (state.change.logger)
[2021-05-17 09:54:54,866] TRACE [Controller id=0 epoch=4] Sending UpdateMetadata request PartitionState(controllerEpoch=4, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition test-topic-0 (state.change.logger)
[2021-05-17 09:54:54,868] TRACE [Controller id=0 epoch=4] Changed state of replica 0 for partition test-topic-0 from NewReplica to OnlineReplica (state.change.logger)
[2021-05-17 09:54:54,869] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=4, leader=0, leaderEpoch=0, isr=0, zkVersion=0, replicas=0, isNew=true) correlation id 1 from controller 0 epoch 4 for partition test-topic-0 (state.change.logger)
[2021-05-17 09:54:55,664] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 epoch 4 starting the become-leader transition for partition test-topic-0 (state.change.logger)
[2021-05-17 09:54:55,991] ERROR [Broker id=0] Error while processing LeaderAndIsr request correlationId 1 received from controller 0 epoch 4 for partition test-topic-0 (state.change.logger)
java.lang.NoSuchMethodError: java.nio.MappedByteBuffer.position(I)Ljava/nio/MappedByteBuffer;
	at kafka.log.AbstractIndex.<init>(AbstractIndex.scala:132)
	at kafka.log.OffsetIndex.<init>(OffsetIndex.scala:54)
	at kafka.log.LogSegment$.open(LogSegment.scala:634)
	at kafka.log.Log.loadSegments(Log.scala:542)
	at kafka.log.Log.<init>(Log.scala:276)
	at kafka.log.Log$.apply(Log.scala:2071)
	at kafka.log.LogManager$$anonfun$getOrCreateLog$1.apply(LogManager.scala:691)
	at kafka.log.LogManager$$anonfun$getOrCreateLog$1.apply(LogManager.scala:659)
	at scala.Option.getOrElse(Option.scala:121)
	at kafka.log.LogManager.getOrCreateLog(LogManager.scala:659)
	at kafka.cluster.Partition$$anonfun$getOrCreateReplica$1.apply(Partition.scala:199)
	at kafka.cluster.Partition$$anonfun$getOrCreateReplica$1.apply(Partition.scala:195)
	at kafka.utils.Pool$$anon$2.apply(Pool.scala:61)
	at java.util.concurrent.ConcurrentHashMap.computeIfAbsent(ConcurrentHashMap.java:1660)
	at kafka.utils.Pool.getAndMaybePut(Pool.scala:60)
	at kafka.cluster.Partition.getOrCreateReplica(Partition.scala:194)
	at kafka.cluster.Partition$$anonfun$5$$anonfun$7.apply(Partition.scala:373)
	at kafka.cluster.Partition$$anonfun$5$$anonfun$7.apply(Partition.scala:373)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.Iterator$class.foreach(Iterator.scala:891)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
	at scala.collection.IterableLike$class.foreach(IterableLike.scala:72)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:234)
	at scala.collection.AbstractTraversable.map(Traversable.scala:104)
	at kafka.cluster.Partition$$anonfun$5.apply(Partition.scala:373)
	at kafka.cluster.Partition$$anonfun$5.apply(Partition.scala:367)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:251)
	at kafka.utils.CoreUtils$.inWriteLock(CoreUtils.scala:259)
	at kafka.cluster.Partition.makeLeader(Partition.scala:367)
	at kafka.server.ReplicaManager$$anonfun$makeLeaders$4.apply(ReplicaManager.scala:1163)
	at kafka.server.ReplicaManager$$anonfun$makeLeaders$4.apply(ReplicaManager.scala:1161)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:130)
	at kafka.server.ReplicaManager.makeLeaders(ReplicaManager.scala:1161)
	at kafka.server.ReplicaManager.becomeLeaderOrFollower(ReplicaManager.scala:1073)
	at kafka.server.KafkaApis.handleLeaderAndIsrRequest(KafkaApis.scala:185)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:110)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:69)
	at java.lang.Thread.run(Thread.java:748)
[2021-05-17 09:54:56,002] TRACE [Controller id=0 epoch=4] Received response {error_code=-1,partitions=[{topic=test-topic,partition=0,error_code=-1}]} for request LEADER_AND_ISR with correlation id 1 sent to broker bolius-mbp.cn.ibm.com:9092 (id: 0 rack: null) (state.change.logger)
[2021-05-17 09:54:56,005] ERROR [Controller id=0] Received error in LeaderAndIsr response LeaderAndIsrResponse(responses={test-topic-0=UNKNOWN_SERVER_ERROR}, error=UNKNOWN_SERVER_ERROR) from broker 0 (state.change.logger)
[2021-05-17 09:54:56,007] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=4, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], offlineReplicas=[]) for partition test-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 2 (state.change.logger)
[2021-05-17 09:54:56,008] TRACE [Controller id=0 epoch=4] Received response {error_code=0} for request UPDATE_METADATA with correlation id 2 sent to broker bolius-mbp.cn.ibm.com:9092 (id: 0 rack: null) (state.change.logger)
